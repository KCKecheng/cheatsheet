# This is just a local sample
# Refer to the official sample - https://rancher.com/docs/rke/latest/en/example-yamls/
# Lastest configuration should be generated by running "rke config"
nodes:
    - address: 10.226.68.200
      internal_address: 172.31.68.200
      hostname_override: cc200.elab.local
      user: rke
      role:
        - controlplane
        - etcd
        - worker
      ssh_key_path: /home/rke/.ssh/id_rsa
      labels:
        cluster_role: master
    - address: 10.226.68.196
      internal_address: 172.31.68.196
      hostname_override: cc196.elab.local
      user: rke
      role:
        - worker
      ssh_key_path: /home/rke/.ssh/id_rsa
      labels:
        cluster_role: worker
    - address: 10.226.68.197
      internal_address: 172.31.68.197
      hostname_override: cc197.elab.local
      user: rke
      role:
        - worker
      ssh_key_path: /home/rke/.ssh/id_rsa
      labels:
        cluster_role: worker
    - address: 10.226.68.198
      internal_address: 172.31.68.198
      hostname_override: cc198.elab.local
      user: rke
      role:
        - worker
      ssh_key_path: /home/rke/.ssh/id_rsa
      labels:
        cluster_role: worker
    - address: 10.226.68.199
      internal_address: 172.31.68.199
      hostname_override: cc199.elab.local
      user: rke
      role:
        - worker
      ssh_key_path: /home/rke/.ssh/id_rsa
      labels:
        cluster_role: worker

ignore_docker_version: false

ssh_agent_auth: true

private_registries:
    - url: docker.io
      is_default: true

cluster_name: k8scc

# The Kubernetes version used. The default versions of Kubernetes
# are tied to specific versions of the system images.
#
# For RKE v0.2.x and below, the map of Kubernetes versions and their system images is
# located here:
# https://github.com/rancher/types/blob/release/v2.2/apis/management.cattle.io/v3/k8s_defaults.go
#
# For RKE v0.3.0 and above, the map of Kubernetes versions and their system images is
# located here:
# https://github.com/rancher/kontainer-driver-metadata/blob/master/rke/k8s_rke_system_images.go
#
# In case the kubernetes_version and kubernetes image in
# system_images are defined, the system_images configuration
# will take precedence over kubernetes_version.
kubernetes_version: v1.15.5-rancher1-2

# System Images are defaulted to a tag that is mapped to a specific
# Kubernetes Version and not required in a cluster.yml.
# Each individual system image can be specified if you want to use a different tag.
#
# For RKE v0.2.x and below, the map of Kubernetes versions and their system images is
# located here:
# https://github.com/rancher/types/blob/release/v2.2/apis/management.cattle.io/v3/k8s_defaults.go
#
# For RKE v0.3.0 and above, the map of Kubernetes versions and their system images is
# located here:
# https://github.com/rancher/kontainer-driver-metadata/blob/master/rke/k8s_rke_system_images.go
#
# system_images:
#     kubernetes: rancher/hyperkube:v1.14.8-rancher1
#     etcd: quay.io/coreos/etcd:v3.3.10-rancher1
#     alpine: rancher/rke-tools:v0.1.50
#     nginx_proxy: rancher/rke-tools:v0.1.50
#     cert_downloader: rancher/rke-tools:v0.1.50
#     kubernetes_services_sidecar: rancher/rke-tools:v0.1.50
#     kubedns: gcr.io/google_containers/k8s-dns-kube-dns:1.15.0
#     dnsmasq: gcr.io/google_containers/k8s-dns-dnsmasq-nanny:1.15.0
#     kubedns_sidecar: gcr.io/google_containers/k8s-dns-sidecar:1.15.0
#     kubedns_autoscaler: gcr.io/google_containers/cluster-proportional-autoscaler:1.3.0
#     pod_infra_container: gcr.io/google_containers/pause:3.1

services:
    kubeproxy:
      extra_args:
        proxy-mode: iptables
        #proxy-mode: ipvs
        #masquerade-all: false
    kube-api:
      service_cluster_ip_range: 10.43.0.0/16
      service_node_port_range: 30000-32767
      pod_security_policy: false
    kube-controller:
      cluster_cidr: 10.42.0.0/16
      service_cluster_ip_range: 10.43.0.0/16
    kubelet:
      cluster_domain: k8scc.local
      cluster_dns_server: 10.43.0.10
      fail_swap_on: false

authentication:
    strategy: x509

authorization:
    mode: rbac

addon_job_timeout: 120

network:
    #plugin: calico
    plugin: flannel
    options:
      flannel_iface: ens192

dns:
    provider: coredns

ingress:
    provider: nginx

addons: |-
    ---
    apiVersion: v1
    kind: Pod
    metadata:
      name: nginx1
      namespace: default
    spec:
      containers:
      - name: nginx1
        image: nginx
        ports:
        - containerPort: 80
